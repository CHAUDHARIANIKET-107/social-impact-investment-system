<div class="main-card" >
  <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 10vh;">
    <h3>Beneficiaries Data Upload</h3>
    <div class="drop-area" (drop)="onDrop($event)" (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)" [class.active]="isDragActive">
      <span>Drag & Drop Excel file here or </span>
      <label class="upload-label">
        <input type="file" class="download-btn" (change)="onFileChange($event)" accept=".xlsx,.xls" class="blue-btn"/>
      </label>
    </div>
    <div class="template-download-link">
      <a href="template/demographic_data_template.xlsx" download class="download-btn">
        <i class="pi pi-download" style="margin-right:6px;"></i>Download Template
      </a>
    </div>
  </div>

  <div *ngIf="excelData.length">
    <h4>Beneficiaries Demographic Data</h4>
    <p-table [value]="excelData" [columns]="columns" [paginator]="true" [rows]="10" [rowsPerPageOptions]="[5,10,20]" class="fancy-table">
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns">{{ col }}</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-row let-columns="columns">
        <tr>
          <td *ngFor="let col of columns">{{ row[columns.indexOf(col)] }}</td>
        </tr>
      </ng-template>
    </p-table>

    <div class="chart-row-center">
      <div class="chart-dropdown">
        <label for="columnSelect">Select Column for Pie Chart:</label>
        <p-dropdown [options]="columns" [(ngModel)]="selectedColumn"
          (onChange)="onColumnSelect()" placeholder="Select"
          [showTransitionOptions]="'0ms'"
          [hideTransitionOptions]="'0ms'">
          <ng-template let-option pTemplate="item">
            <span>{{ option }}</span>
          </ng-template>
        </p-dropdown>
      </div>
      <div *ngIf="pieData" class="chart-pie-horizontal">
        <p-chart type="pie" [data]="pieData" [options]="{ plugins: { legend: { position: 'right', align: 'center' } } }"
        ></p-chart>
      </div>
    </div>
  </div>
</div>
